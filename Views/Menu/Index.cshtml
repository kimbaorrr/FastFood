@model List<CustomCategoryViewModel>

<!--====== Start Page Section ======-->
<section class="page-banner">
    <div class="page-bg-wrapper p-r z-1 bg_cover pt-100 pb-110" style="background-image: url(/public_page/assets/images/bg/page-bg.jpg);">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <!--=== Page Banner Content ===-->
                    <div class="page-banner-content text-center">
                        <h1 class="page-title">@ViewBag.Title</h1>
                        <ul class="breadcrumb-link">
                            <li><a href="@Url.Action("Index", "Home")">Trang chủ</a></li>
                            <li class="active">@ViewBag.Title</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section><!--====== End Page Section ======-->
<!--====== Start Menu Page Section ======-->
<section class="menu-grid-section gray-bg pt-110 pb-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title mb-55 text-center">
                    <h2>Khám Phá Thực Đơn</h2>
                    <p>Đắm chìm trong những món ăn nhanh hấp dẫn, từ burger ngon miệng đến khoai tây chiên giòn rụm. Mỗi món ăn đều được chuẩn bị với nguyên liệu tươi ngon, mang đến cho bạn trải nghiệm ẩm thực tuyệt vời ngay trong vòng tay!</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="foodix-tabs style-two mb-70">
                    <ul class="nav nav-tabs">
                        @foreach (var (cat, i) in Model.Select((c, i) => (c, i)))
                        {
                            <li class="nav-item">
                                <button class="nav-link @(i == 0 ? "active" : "")"
                                        data-bs-toggle="tab"
                                        data-bs-target="#cat_@cat.Category.CategoryId">
                                    @cat.Category.CategoryName
                                </button>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="tab-content">
                    @foreach (var (cat, i) in Model.Select((c, i) => (c, i)))
                    {
                        var category = cat.Category;
                        <div class="tab-pane fade @(i == 0 ? "show active" : "")"
                             id="cat_@category.CategoryId"
                             style="max-height: 75vh;overflow-y: scroll; overflow-x: hidden;">

                            <div class="row">
                                @foreach (var product in cat.Products)
                                {
                                    string image = product.Image?.Split(',')[0] ?? string.Empty;
                                    <div class="col-xl-3 col-md-6 col-sm-12">
                                        <div class="menu-item style-four mb-30">
                                            <div class="d-flex justify-content-center align-items-center mx-auto overflow-hidden"
                                                 style="width: 220px;height: 200px;">
                                                <img src="@image" alt="menu image"
                                                     class="object-fit-fill"
                                                     width="100%" height="100%">
                                            </div>
                                            <div class="menu-info">
                                                <div class="menu-meta">
                                                    <span class="price">
                                                        <span class="currency">$</span>
                                                        @product.FinalPrice
                                                        @if (product.Discount != 0)
                                                        {
                                                            <span class="text-decoration-line-through ps-1" style="color:slategray;">
                                                                @product.OriginalPrice
                                                            </span>
                                                        }
                                                    </span>
                                                    <span class="rating">
                                                        <i class="fas fa-star"></i>
                                                        @if (product.ProductReviews.Any())
                                                        {
                                                            <a href="#">
                                                                @product.ProductReviews.Average(x => x.StarRating)
                                                            </a>
                                                        }
                                                        else
                                                        {
                                                            <a href="#">3</a>
                                                        }
                                                    </span>
                                                </div>
                                                <h4 class="title">
                                                    <a href="@Url.Action("Detail", "Menu", new { productId = product.ProductId })">
                                                        @product.ProductName
                                                    </a>
                                                </h4>
                                                <p class="text-secondary" style="font-weight: 500;">@product.Summary</p>
                                                <button type="button"
                                                        class="add-to-cart-btn theme-btn style-two mt-3"
                                                        style="padding: 12px 0;"
                                                        data-product-id="@product.ProductId"
                                                        data-quantity="1">
                                                    <i class="far fa-cart-plus"></i> Thêm vào giỏ
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    }
                </div>

            </div>
        </div>
    </div>
</section><!--====== End Menu Page Section ======-->
