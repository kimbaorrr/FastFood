@using FastFood.Models
@model EmployeeLoginViewModel

@{
	ViewBag.Title = "Đăng nhập hệ thống";
	Layout = "~/Areas/Admin/Views/Shared/_AuthLayout.cshtml";
}

<div class="mb-4">
	<form id="loginForm" class="authentication-form">
		@Html.AntiForgeryToken()
		<div class="mb-3">
			@Html.LabelFor(m => m.UserName, new { @class = "form-label" })
			@Html.TextBoxFor(m => m.UserName, new { @class = "form-control", @autofocus = "autofocus", @required = "required" })
		</div>
		<div class="mb-3">
			<a href="@Url.Action("ForgetPassword", "Account", new { area = "Admin" })" class="text-muted text-unline-dashed float-end ms-1">Quên mật khẩu ?</a>
			@Html.LabelFor(m => m.Password, new { @class = "form-label" })
			@Html.PasswordFor(m => m.Password, new { @class = "form-control", @required = "required" })
		</div>
		<div class="mb-3">
			<div class="form-check">
				@Html.LabelFor(m => m.RememberMe, new { @class = "form-check-label" })
				@Html.CheckBoxFor(m => m.RememberMe, new { @class = "form-check-input" })
			</div>
		</div>

		<div class="d-grid mb-1 text-center">
			<button class="btn btn-soft-primary" type="submit" id="submitBtn">
				Đăng nhập
				<div class="spinner-border text-secondary ms-1 mt-1" style="height: 12px; width: 12px; display: none;" id="loadingSpinner"></div>
			</button>
		</div>

	</form>
</div>

<script>
	$(document).ready(function () {
		$('#loginForm').on('submit', function (e) {
			e.preventDefault();

			$('#loadingSpinner').show();
			$('#submitBtn').prop('disabled', true);

			$.ajax({
				url: '@Url.Action("Login", "Account", new { area = "Admin" })',
				type: 'POST',
				data: $(this).serialize(),
				success: function (response) {
					$('#loadingSpinner').hide();
					$('#submitBtn').prop('disabled', false);

					if (response.success) {
						window.location.href = "@Url.Action("Index", "Home", new { area = "Admin" })";
					} else {
						alertMessage(response.message, response.type);
					}
				},
				error: function () {
					$('#loadingSpinner').hide();
					$('#submitBtn').prop('disabled', false);
					alertMessage('Có lỗi xảy ra, vui lòng thử lại.', 'var(--bs-danger)');
				}
			});
		});
	});
</script>
